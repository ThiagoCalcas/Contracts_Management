SELECT TBL_EGTTV.NomeEGTTV, Format(Nz([QRY_C40_DispendioPorFornecedorAno].SomaDeValor,0),"Currency") AS Valor0, IIf(Valor0=0,0,QRY_C40_DispendioPorFornecedorAno.AnoPgto) AS Ano, Format(Nz([QRY_C40_DispendioPorFornecedorAno-1].SomaDeValor,0),"Currency") AS Valor1, IIf(Valor1=0,0,[QRY_C40_DispendioPorFornecedorAno-1].AnoPgto) AS [Ano-1], Format(Nz([QRY_C40_DispendioPorFornecedorAno-2].SomaDeValor,0),"Currency") AS Valor2, IIf(Valor2=0,0,[QRY_C40_DispendioPorFornecedorAno-2].AnoPgto) AS [Ano-2]
FROM ((TBL_EGTTV LEFT JOIN [QRY_C40_DispendioPorFornecedorAno-1] ON TBL_EGTTV.NomeEGTTV = [QRY_C40_DispendioPorFornecedorAno-1].NomeEGTTV) LEFT JOIN QRY_C40_DispendioPorFornecedorAno ON TBL_EGTTV.NomeEGTTV = QRY_C40_DispendioPorFornecedorAno.NomeEGTTV) LEFT JOIN [QRY_C40_DispendioPorFornecedorAno-2] ON TBL_EGTTV.NomeEGTTV = [QRY_C40_DispendioPorFornecedorAno-2].NomeEGTTV
ORDER BY QRY_C40_DispendioPorFornecedorAno.SomaDeValor DESC;
